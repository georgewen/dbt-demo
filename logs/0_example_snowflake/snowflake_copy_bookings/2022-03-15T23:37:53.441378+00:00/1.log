[2022-03-15 23:37:56,719] {taskinstance.py:1037} INFO - Dependencies all met for <TaskInstance: 0_example_snowflake.snowflake_copy_bookings manual__2022-03-15T23:37:53.441378+00:00 [queued]>
[2022-03-15 23:37:56,733] {taskinstance.py:1037} INFO - Dependencies all met for <TaskInstance: 0_example_snowflake.snowflake_copy_bookings manual__2022-03-15T23:37:53.441378+00:00 [queued]>
[2022-03-15 23:37:56,734] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2022-03-15 23:37:56,735] {taskinstance.py:1244} INFO - Starting attempt 1 of 1
[2022-03-15 23:37:56,736] {taskinstance.py:1245} INFO - 
--------------------------------------------------------------------------------
[2022-03-15 23:37:56,748] {taskinstance.py:1264} INFO - Executing <Task(SnowflakeOperator): snowflake_copy_bookings> on 2022-03-15 23:37:53.441378+00:00
[2022-03-15 23:37:56,757] {standard_task_runner.py:52} INFO - Started process 1388 to run task
[2022-03-15 23:37:56,762] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', '0_example_snowflake', 'snowflake_copy_bookings', 'manual__2022-03-15T23:37:53.441378+00:00', '--job-id', '22', '--raw', '--subdir', 'DAGS_FOLDER/load_snowflake.py', '--cfg-path', '/tmp/tmp52m52v33', '--error-file', '/tmp/tmp051f3wgp']
[2022-03-15 23:37:56,763] {standard_task_runner.py:77} INFO - Job 22: Subtask snowflake_copy_bookings
[2022-03-15 23:37:56,826] {logging_mixin.py:109} INFO - Running <TaskInstance: 0_example_snowflake.snowflake_copy_bookings manual__2022-03-15T23:37:53.441378+00:00 [running]> on host 15be6920bf2c
[2022-03-15 23:37:56,920] {taskinstance.py:1431} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=0_example_snowflake
AIRFLOW_CTX_TASK_ID=snowflake_copy_bookings
AIRFLOW_CTX_EXECUTION_DATE=2022-03-15T23:37:53.441378+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-03-15T23:37:53.441378+00:00
[2022-03-15 23:37:56,921] {snowflake.py:127} INFO - Executing: copy into PUBLIC.BOOKINGS_1 from s3://gw-test-open-snowflake/***/ FILES=('bookings_1.csv') FILE_FORMAT=(TYPE='CSV' SKIP_HEADER=1);copy into PUBLIC.BOOKINGS_2 from s3://gw-test-open-snowflake/***/ FILES=('bookings_2.csv') FILE_FORMAT=(TYPE='CSV' SKIP_HEADER=1);
[2022-03-15 23:37:56,934] {base.py:79} INFO - Using connection to: id: snowflake_conn. Host: ms36734.ap-southeast-2.snowflakecomputing.com, Port: None, Schema: PUBLIC, Login: ggww128, Password: ***, extra: {'extra__snowflake__account': 'ms36734', 'extra__snowflake__aws_access_key_id': '', 'extra__snowflake__aws_secret_access_key': '***', 'extra__snowflake__database': 'DEMO_DBT', 'extra__snowflake__region': 'ap-southeast-2', 'extra__snowflake__role': 'DBT_DEV_ROLE', 'extra__snowflake__warehouse': 'DBT_DEV_WH'}
[2022-03-15 23:37:56,935] {connection.py:262} INFO - Snowflake Connector for Python Version: 2.4.6, Python Version: 3.7.12, Platform: Linux-5.10.76-linuxkit-x86_64-with-debian-10.11
[2022-03-15 23:37:56,937] {connection.py:869} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2022-03-15 23:37:56,938] {connection.py:886} INFO - Setting use_openssl_only mode to False
[2022-03-15 23:37:57,753] {cursor.py:637} INFO - query: [ALTER SESSION SET autocommit=True]
[2022-03-15 23:37:57,824] {cursor.py:661} INFO - query execution done
[2022-03-15 23:37:57,826] {snowflake.py:283} INFO - Running statement: copy into PUBLIC.BOOKINGS_1 from s3://gw-test-open-snowflake/***/ FILES=('bookings_1.csv') FILE_FORMAT=(TYPE='CSV' SKIP_HEADER=1);, parameters: None
[2022-03-15 23:37:57,827] {cursor.py:637} INFO - query: [copy into PUBLIC.BOOKINGS_1 from s3://gw-test-open-snowflake/***/ FILES=('bo...]
[2022-03-15 23:38:00,252] {cursor.py:661} INFO - query execution done
[2022-03-15 23:38:00,253] {snowflake.py:291} INFO - Statement execution info - {'file': 's3://gw-test-open-snowflake/***/bookings_1.csv', 'status': 'LOADED', 'rows_parsed': 7, 'rows_loaded': 7, 'error_limit': 1, 'errors_seen': 0, 'first_error': None, 'first_error_line': None, 'first_error_character': None, 'first_error_column_name': None}
[2022-03-15 23:38:00,254] {json_result.py:127} INFO - fetching data done
[2022-03-15 23:38:00,255] {snowflake.py:294} INFO - Rows affected: 1
[2022-03-15 23:38:00,255] {snowflake.py:295} INFO - Snowflake query id: 01a2f3c9-3200-c95f-0000-0000aa297059
[2022-03-15 23:38:00,256] {snowflake.py:283} INFO - Running statement: copy into PUBLIC.BOOKINGS_2 from s3://gw-test-open-snowflake/***/ FILES=('bookings_2.csv') FILE_FORMAT=(TYPE='CSV' SKIP_HEADER=1);, parameters: None
[2022-03-15 23:38:00,256] {cursor.py:637} INFO - query: [copy into PUBLIC.BOOKINGS_2 from s3://gw-test-open-snowflake/***/ FILES=('bo...]
[2022-03-15 23:38:00,756] {cursor.py:661} INFO - query execution done
[2022-03-15 23:38:00,757] {snowflake.py:291} INFO - Statement execution info - {'file': 's3://gw-test-open-snowflake/***/bookings_2.csv', 'status': 'LOAD_SKIPPED', 'rows_parsed': 0, 'rows_loaded': 0, 'error_limit': None, 'errors_seen': 1, 'first_error': 'File was loaded before.', 'first_error_line': None, 'first_error_character': None, 'first_error_column_name': None}
[2022-03-15 23:38:00,758] {json_result.py:127} INFO - fetching data done
[2022-03-15 23:38:00,758] {snowflake.py:294} INFO - Rows affected: 1
[2022-03-15 23:38:00,759] {snowflake.py:295} INFO - Snowflake query id: 01a2f3ca-3200-c8fb-0000-0000aa29605d
[2022-03-15 23:38:00,759] {connection.py:499} INFO - closed
[2022-03-15 23:38:00,783] {connection.py:502} INFO - No async queries seem to be running, deleting session
[2022-03-15 23:38:00,865] {taskinstance.py:1282} INFO - Marking task as SUCCESS. dag_id=0_example_snowflake, task_id=snowflake_copy_bookings, execution_date=20220315T233753, start_date=20220315T233756, end_date=20220315T233800
[2022-03-15 23:38:00,918] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-03-15 23:38:00,949] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
